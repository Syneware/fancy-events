var EventEmitter=function(){"use strict";function e(e,t,i){return Object.defineProperty(e,t,{value:i,configurable:!0,writable:!0,enumerable:!0})}function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return class{constructor({mode:i="wildcard",includeStack:s=!1,delimiter:r="."}={}){this._listeners={},this._wildcardsRegex={},this._listenerRegex={},this.mode="wildcard",this.includeStack=!1,this.delimiter=".",this.addListener=(i,s,r={})=>{if(t(this._listeners,i)||e(this._listeners,i,[]),this.emit("newListener",i,s),!t(this._wildcardsRegex,i)){const t=i.split(this.delimiter).map((e=>"*"===e?"\\w*":e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))),s=new RegExp(`^${t.join("\\"+this.delimiter)}$`);e(this._wildcardsRegex,i,s)}t(this._listenerRegex,i)||e(this._listenerRegex,i,new RegExp(i)),this._listeners[i].push({callback:s,once:!!(null==r?void 0:r.once)})},this.on=this.addListener,this.once=(e,t,i={})=>{this.addListener(e,t,Object.assign(Object.assign({},i),{once:!0}))},this._removeListener=(e,t)=>{if(this.listenerCount(e)){let i=this._listeners[e].findIndex((e=>(null==e?void 0:e.callback)===t));if(i>-1)return this._listeners[e].splice(i,1),!0}return!1},this.removeListener=(e,t)=>{this._removeListener(e,t)&&this.emit("removeListener",e,t)},this.off=this.removeListener,this.removeAllListeners=e=>{if(e&&this.listeners(e).length){const t=this.listeners(e);delete this._listeners[e];for(const i of t)this.emit("removeListener",e,i)}},this.eventNames=()=>Object.keys(this._listeners),this.listenerCount=e=>e?this.listeners(e).length:0,this.listeners=e=>e&&t(this._listeners,e)?this._listeners[e]:[],this._getStack=()=>{const e=Error.prepareStackTrace,t=new Error;Error.prepareStackTrace=(e,t)=>t;const i=t.stack;return Error.prepareStackTrace=e,(null==i?void 0:i.slice(2))||[]},this.emit=(e,...i)=>{var s,r,n,l;const o={event:e};this.includeStack&&(o.stack=this._getStack().map((e=>({typeName:e.getTypeName(),methodName:e.getMethodName(),function:e.getFunction(),functionName:e.getFunctionName(),fileName:e.getFileName(),lineNumber:e.getLineNumber()}))));const c=(e,t=[])=>{var s;for(const r of t)r.once&&this._removeListener(e,null==r?void 0:r.callback),null===(s=null==r?void 0:r.callback)||void 0===s||s.call(r,o,...i)};if("wildcard"===this.mode)for(const i in this._listeners)t(this._listeners,i)&&(null===(r=null===(s=this._wildcardsRegex[i])||void 0===s?void 0:s.test)||void 0===r?void 0:r.call(s,e))&&c(i,this._listeners[i]);else if("regex"===this.mode)for(const i in this._listeners)t(this._listeners,i)&&(null===(l=null===(n=this._listenerRegex[i])||void 0===n?void 0:n.test)||void 0===l?void 0:l.call(n,e))&&c(i,this._listeners[i]);else t(this._listeners,e)&&c(e,this._listeners[e])},i&&(this.mode=i),void 0!==s&&(this.includeStack=s),r&&(this.delimiter=r)}}}();
